<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# 2025-12-03 JavaScript授業ノート

**授業日時**: 2025年12月3日（水）
**科目**: JavaScript
**範囲**: Chapter 6-11〜6-15（P234〜P249）

***

## 学んだこと

### Chapter 6-11: 1つずつ遅延させよう

複数の画像を順番に表示するため、`delay`プロパティを使って時間差を作る方法を学習。

**ポイント**:

- `delay: i * 300` でインデックスに応じた遅延を設定
- `i`は配列のインデックス（0, 1, 2...）
- 最初の画像は0秒、2番目は0.3秒、3番目は0.6秒...と遅延

***

### Chapter 6-12: 色々な画像のアニメーション

様々なアニメーション効果を組み合わせて表現を豊かにする。

**学習した効果**:

- `rotate: ['x 90deg', 0]` - X軸回転（横に倒れた状態から起き上がる）
- `rotate: ['5deg', 0]` - Z軸回転（軸指定なし、平面的な回転）
- `translate: ['0 50px', 0]` - 移動（下から浮き上がる）
- `scale: [1.1, 1]` - 拡大縮小（110%から100%に）
- `filter: ['blur(20px)', 'blur(0)']` - ぼかし効果（ぼやけた状態からくっきり）

**重要な違い**:

- `rotate`で軸指定なし = Z軸回転（平面）
- `rotate`で値が0の場合はシングルクォーテーション不要
- `scale`は単位不要、数値のみ
- `filter`は文字列で指定、`blur(0)`のように括弧が必要

***

### Chapter 6-13: スクロールとアニメーションを組み合わせよう

スクロールに連動してアニメーションを発火させる仕組みを学習。

**新しい技術**:

- **Intersection Observer API** - 要素が画面内に入ったかを監視
- ページ読み込み時ではなく、スクロールイベントに反応
- 従来のスクロールイベントより効率的

**完成コードの構成**:

```
13-demo/
  ├── index.html
  ├── js/
  │   └── script.js
  ├── css/
  │   └── style.css
  └── images/
      └── kirin.jpg
```


***

### Chapter 6-14: Intersection Observerの仕組み

Intersection Observer APIの基本構造と、コールバック関数の仕組みを理解。

**基本コード**:

```javascript
// 監視対象が範囲内に現れたら実行する動作
const showkirin = () => {
    console.log('キリンさんです!');
};

// 監視ロボットの設定
const kirinObserver = new IntersectionObserver(showkirin);

// #kirinを監視するよう指示
kirinObserver.observe(document.querySelector('#kirin'));
```

**重要な概念**:

- `IntersectionObserver` = コンストラクター関数（クラスのような使い方）
- Web API（ブラウザが提供する機能）
- `new`でインスタンス（監視ロボット）を作成
- コールバック関数として`showkirin`を渡す

**講師の例（コールバック関数の理解）**:

```javascript
function test(callback) {
    const weather = '☀️';
    callback(weather);  // abc関数を実行して天気を渡す
}

function abc(x) {
    console.log('abcを実行しました', x);
}

test(abc);  // abc関数を渡す（実行はしない）
```

**addEventListener との共通点**:

```javascript
// クリックイベント
要素.addEventListener('click', (event) => {
    console.log(event.target);
});

// 交差監視
new IntersectionObserver((entries) => {
    console.log(entries[0].target);
});
```

→ どちらもブラウザが自動で情報を作成し、コールバック関数に渡す

***

### Chapter 6-15: 交差状態の情報を見てみよう

監視対象の要素情報を取得する方法を学習。

**コード**:

```javascript
const showkirin = (entries) => {
    console.log(entries[0].target);  // 監視対象のHTML要素
};
```

**IntersectionObserverEntry のプロパティ**:


| プロパティ | 意味 |
| :-- | :-- |
| `target` | 監視対象の要素（最重要） |
| `isIntersecting` | 画面内に入っているか（true/false） |
| `intersectionRatio` | 見えている割合（0〜1） |
| `boundingClientRect` | 要素のサイズや位置 |
| `intersectionRect` | 表示されている部分のサイズや位置 |
| `rootBounds` | 監視領域のサイズや位置 |
| `time` | 交差が記録された時刻（ミリ秒） |

**使い方**:

- `entries[0]` - 監視情報オブジェクト
- `entries[0].target` - 監視対象のHTML要素を取得
- 次のステップでこの要素にアニメーションを適用予定

***

## コード例

### Chapter 6-11（遅延アニメーション）

```javascript
const items = document.querySelectorAll('.img-item');

const keyframes = {
    opacity: [0, 1],
};

for (let i = 0; i < items.length; i++) {
    const options = {
        duration: 600,
        delay: i * 300,  // インデックスに応じた遅延
        fill: 'forwards',
    };
    items[i].animate(keyframes, options);
}
```


### Chapter 6-12（回転アニメーション）

```javascript
const keyframes = {
    opacity: [0, 1],
    rotate: ['x 90deg', 0],  // X軸で90度回転
};
```


### Chapter 6-12（下から浮き上がる）

```javascript
const keyframes = {
    opacity: [0, 1],
    translate: ['0 50px', 0],  // 下から移動
};
```


### Chapter 6-12（ふわふわ）

```javascript
const keyframes = {
    opacity: [0, 1],
    rotate: ['5deg', 0],  // 平面回転
    scale: [1.1, 1],      // 縮小
};
```


### Chapter 6-12（ぼかし）

```css
.img-item {
    filter: blur(20px);  /* 初期状態 */
}
```

```javascript
const keyframes = {
    filter: ['blur(20px)', 'blur(0)'],
};
```


### Chapter 6-13〜6-15（スクロール連動の基礎）

```javascript
// 監視対象が範囲内に現れたら実行する動作
const showkirin = (entries) => {
    console.log(entries[0].target);
};

// 監視ロボットの設定
const kirinObserver = new IntersectionObserver(showkirin);

// #kirinを監視するよう指示
kirinObserver.observe(document.querySelector('#kirin'));
```


***

## 参考リンク

- [MDN - Intersection Observer API](https://developer.mozilla.org/ja/docs/Web/API/Intersection_Observer_API)
- [MDN - IntersectionObserver](https://developer.mozilla.org/ja/docs/Web/API/IntersectionObserver)
- [MDN - IntersectionObserverEntry](https://developer.mozilla.org/ja/docs/Web/API/IntersectionObserverEntry)
- [MDN - Element.animate()](https://developer.mozilla.org/ja/docs/Web/API/Element/animate)

***

## 疑問点・理解したこと

### Q: `IntersectionObserver`はクラス？コンストラクター？

**A**: 両方正しい。

- MDNでは「コンストラクター」と表記（技術的に正確）
- モダンな表現では「クラス」
- Web API（ブラウザの機能）として提供されている
- `new`でインスタンスを作成して使う


### Q: コールバック関数の仕組みは？

**A**:

- 関数を引数として渡す（`test(abc)`のように関数名だけ）
- 渡された関数は後で実行される
- `addEventListener`と同じパターン
- ブラウザが情報を自動作成してコールバック関数に渡す

***

## 次回の予定

**Chapter 6-16**: アニメーションを実装

- `entries[0].target.animate()`でスクロール連動アニメーション完成
- キリンが右からスライドしながら表示される効果を実装

