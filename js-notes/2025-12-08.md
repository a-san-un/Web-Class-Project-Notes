# 2025-12-08 JavaScript授業ノート（ローディング＆画像ギャラリー）

## 授業情報

- 日付: 2025-12-08
- 科目: JavaScript（Web Animations API／画像ギャラリー）

***

## 今日学んだこと

### ローディング画面のアニメーション

- `Element.animate()` を使って、`#loading` 全体にぼかしと背景色のフェードアウトを付けた。`backdropFilter` や `background` の値を配列で渡し、`duration`・`delay`・`easing`・`fill` などのタイミングオプションで動きを調整した。[^1][^2][^3]
- ローディングテキストには `offset` を使ったキーフレームを設定し、アニメーション全体の 0〜80% は表示、80〜100% の間だけ `opacity: 1 → 0` で消えるようにした。[^4]


### 画像ギャラリーのHTML＋CSS

- `.gallery` セクションに「大きなメイン画像」と「サムネイル一覧」を追加し、スマホでは縦並び（`flex-direction: column-reverse`）、PC では左右2カラム（`flex-direction: row`）になるレイアウトを組んだ。[^5][^6]
- サムネイルとメイン画像には `aspect-ratio: 3/4` と `object-fit: cover` を指定して、どの画像でも縦長 3:4 比率でそろうようにした。[^7][^8]


### NodeList とループ処理

- `document.querySelector('.gallery-image img')` でメイン画像を1枚だけ、`document.querySelectorAll('.gallery-thumbnails img')` でサムネイル9枚を `NodeList` として取得した。[^9][^10]
- 最初は `for (let i = 0; i < thumbImages.length; i++) { ... }` でループを書き、後から `thumbImages.forEach((thumb) => { ... })` に書き換えて、複数要素への同じ処理を簡潔に書く方法を学んだ。[^11][^12]


### イベントオブジェクトと画像切り替え

- `addEventListener('mouseover', (event) => { ... })` でサムネイルにカーソルが乗ったときのイベントを取得し、`event.target` から「実際にホバーされた `<img>` 要素」を参照した。[^13][^14]
- `event.target.src` を `mainImage.src` に代入して、大きい画像の `src` 属性をサムネイルと同じファイルに書き換え、同時に `mainImage.animate({ opacity: [0, 1] }, 500)` でフェードインさせる演出を作った。[^2][^3][^1]


### 属性値の活用と data 属性

- 画像の `alt` 属性と `data-extra` 属性を使い、`const caption = \`${event.target.alt}（${event.target.dataset.extra}）\`;` でキャプション文字列を組み立てて、`#caption` 要素の `textContent` に表示した。[^15][^13]
- `data-*` 属性は `dataset.名前` で参照できることを確認し、HTML のマークアップ側に追加情報を埋め込んで JavaScript から取り出すパターンを理解した。[^15]

***

## コード例（要点だけ）

```js
// ローディング画面
const loadingAreaGrey = document.querySelector('#loading');
const loadingText = document.querySelector('#loading p');

window.addEventListener('load', () => {
  loadingAreaGrey.animate(
    {
      backdropFilter: ['blur(10px)', 'blur(0)'],
      background: ['rgba(238, 221, 136, 1)', 'rgba(238, 221, 136, 0)'],
      visibility: 'hidden',
    },
    { duration: 2000, delay: 1200, easing: 'ease', fill: 'forwards' }
  );

  loadingText.animate(
    [
      { opacity: 1, offset: .8 },
      { opacity: 0, offset: 1 },
    ],
    { duration: 1200, easing: 'ease', fill: 'forwards' }
  );
});
```

```js
// 画像ギャラリー
const mainImage = document.querySelector('.gallery-image img');
const thumbImages = document.querySelectorAll('.gallery-thumbnails img');

thumbImages.forEach((thumb) => {
  thumb.addEventListener('mouseover', (e) => {
    const caption = `${e.target.alt} （${e.target.dataset.extra}）`;
    document.querySelector('#caption').textContent = caption;

    mainImage.src = e.target.src;
    mainImage.animate({ opacity: [0, 1] }, 500);
  });
});
```


***

## 参考リンク

- Web Animations API と `Element.animate()` の基本[^3][^1][^2]
- NodeList と `forEach()` の使い方[^16][^11][^9]
- data 属性と `dataset` の扱い方[^15]

***

## 疑問点・メモ

- `offset` を 2 点だけでなく 3 点以上指定した場合の動き方（複雑な時間配分）を、今後もう少し試してみたい。
- 大きい画像のフェードインと、ローディング時のフェードアウトを「重ねてタイミング調整」する場合、`delay` と `duration` をどのように設計すると自然に見えるか、別パターンも作って比較してみたい。
<span style="display:none">[^17][^18][^19][^20][^21][^22][^23][^24][^25][^26]</span>

<div align="center">⁂</div>

[^1]: https://developer.mozilla.org/ja/docs/Web/API/Element/animate

[^2]: https://developer.mozilla.org/ja/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API

[^3]: https://developer.mozilla.org/ja/docs/Web/API/Web_Animations_API

[^4]: https://github.com/mdn/translated-content/blob/main/files/ja/web/api/web_animations_api/keyframe_formats/index.md?plain=1

[^5]: https://2ality.com/2025/10/css-layout.html

[^6]: https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Properties/flex-direction

[^7]: https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio

[^8]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_box_sizing/Understanding_aspect-ratio

[^9]: https://developer.mozilla.org/ja/docs/Web/API/NodeList

[^10]: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector

[^11]: https://developer.mozilla.org/ja/docs/Web/API/NodeList/forEach

[^12]: https://ginpen.com/2018/12/11/nodelist-foreach/

[^13]: https://developer.mozilla.org/ja/docs/Web/API/Element

[^14]: https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event

[^15]: https://watashi.xyz/js-dataset/

[^16]: https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach

[^17]: https://developer.mozilla.org/ja/docs/Web/API/Web_Animations_API/Web_Animations_API_Concepts

[^18]: https://developer.mozilla.org/ja/docs/Web/API/Element/animationend_event

[^19]: https://www.webdesignleaves.com/pr/jquery/web-animation-api-basic.html

[^20]: https://developer.mozilla.org/ja/docs/Web/API/Animation

[^21]: https://chaika.hatenablog.com/entry/2019/09/09/083000

[^22]: https://web.dev/learn/css/transitions?hl=ja

[^23]: https://gorogoronyan.web.fc2.com/htmlsample/src/TestJS_NodeList_forEach_format01.html

[^24]: https://qiita.com/KDE_SPACE/items/e21bb31dd4d9c162c4a6

[^25]: https://developer.mozilla.org/ja/docs/Web/API/NodeList/entries

[^26]: https://caniuse.com/mdn-api_nodelist_foreach

